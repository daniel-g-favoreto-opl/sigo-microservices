{"timestamp":"2025-11-29T04:16:32.709683Z","level":"info","event":"DAG bundles loaded: dags-folder, example_dags","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2025-11-29T04:16:32.710556Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/postgre_insert_csvs_dag.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2025-11-29T04:16:32.785533Z","level":"warning","event":"The `airflow.decorators.dag` attribute is deprecated. Please use `'airflow.sdk.dag'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/postgre_insert_csvs_dag.py","lineno":1,"logger":"py.warnings"}
{"timestamp":"2025-11-29T04:16:32.785678Z","level":"warning","event":"The `airflow.decorators.task` attribute is deprecated. Please use `'airflow.sdk.task'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/postgre_insert_csvs_dag.py","lineno":1,"logger":"py.warnings"}
{"timestamp":"2025-11-29T04:16:32.843312Z","level":"info","event":"Task instance is in running state","logger":"task.stdout"}
{"timestamp":"2025-11-29T04:16:32.845097Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.QUEUED","logger":"task.stdout"}
{"timestamp":"2025-11-29T04:16:32.845255Z","level":"info","event":"Current task name:criar_tabelas","logger":"task.stdout"}
{"timestamp":"2025-11-29T04:16:32.845308Z","level":"info","event":"Dag name:processar_ttks_para_postgres","logger":"task.stdout"}
{"timestamp":"2025-11-29T04:16:32.845418Z","level":"info","event":"üóÑÔ∏è Criando estrutura de tabelas no PostgreSQL...","logger":"task.stdout"}
{"timestamp":"2025-11-29T04:16:32.893564Z","level":"info","event":"Running statement: \n        CREATE TABLE IF NOT EXISTS clientes (\n            id SERIAL PRIMARY KEY,\n            nome VARCHAR(100) UNIQUE NOT NULL,\n            data_criacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n            ativo BOOLEAN DEFAULT TRUE\n        );\n        \n        -- Cria √≠ndice para melhor performance\n        CREATE INDEX IF NOT EXISTS idx_clientes_nome ON clientes(nome);\n        , parameters: None","logger":"airflow.task.hooks.airflow.providers.***.hooks.***.PostgresHook","filename":"sql.py","lineno":810}
{"timestamp":"2025-11-29T04:16:32.900512Z","level":"info","event":"‚úÖ Tabela 'clientes' criada/verificada com sucesso!","logger":"task.stdout"}
{"timestamp":"2025-11-29T04:16:32.912149Z","level":"info","event":"Running statement: \n        CREATE TABLE IF NOT EXISTS ttks (\n            id BIGINT PRIMARY KEY,\n            cliente_id INTEGER NOT NULL,\n            reference VARCHAR(255),\n            title TEXT,\n            type VARCHAR(100),\n            state VARCHAR(100),\n            priority VARCHAR(50),\n            category VARCHAR(255),\n            subcategory_id INTEGER,\n            description TEXT,\n            creation_date TIMESTAMP,\n            resolution_due_date TIMESTAMP,\n            category_id INTEGER,\n            symptom_id INTEGER,\n            previous_state_id INTEGER,\n            creation_team VARCHAR(255),\n            change_id_n VARCHAR(255),\n            public_flag INTEGER,\n            resolution_sla_minute INTEGER,\n            creation_team_public_id VARCHAR(255),\n            urgency_id INTEGER,\n            urgency VARCHAR(100),\n            impact_id INTEGER,\n            origin VARCHAR(255),\n            cause_type VARCHAR(255),\n            cause_type_id INTEGER,\n            subcategory_public_id VARCHAR(255),\n            resolution_estimated_date TIMESTAMP,\n            change_user_internal_flag INTEGER,\n            sla_minute INTEGER,\n            previous_state VARCHAR(100),\n            service_id_count_by_client TEXT,\n            original_ticket_id VARCHAR(255),\n            start_date TIMESTAMP,\n            tag VARCHAR(255),\n            automatic_flag INTEGER,\n            resolution_sla_unity VARCHAR(100),\n            creation_user_name VARCHAR(255),\n            priority_id INTEGER,\n            state_id INTEGER,\n            change_user_id INTEGER,\n            state_date TIMESTAMP,\n            change_date TIMESTAMP,\n            previous_resolution_estimated_date TIMESTAMP,\n            impact VARCHAR(100),\n            type_id INTEGER,\n            symptom_public_id VARCHAR(255),\n            impact_public_id VARCHAR(255),\n            creation_user_id INTEGER,\n            creation_user_internal_flag INTEGER,\n            automatic_creation_flag INTEGER,\n            change_team_id INTEGER,\n            subcategory VARCHAR(255),\n            priority_public_id VARCHAR(255),\n            entity VARCHAR(100),\n            max_id BIGINT,\n            hierarq_escalation INTEGER,\n            change_id VARCHAR(255),\n            origin_id INTEGER,\n            observations TEXT,\n            change_user_name VARCHAR(255),\n            symptom VARCHAR(255),\n            previous_service_id_count_by_client TEXT,\n            category_public_id VARCHAR(255),\n            change_team VARCHAR(255),\n            tim_associated_tickets TEXT,\n            data_importacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n            data_atualizacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n            CONSTRAINT fk_cliente FOREIGN KEY (cliente_id) REFERENCES clientes(id) ON DELETE CASCADE\n        );\n        \n        -- Cria √≠ndices para melhor performance\n        CREATE INDEX IF NOT EXISTS idx_ttks_cliente_id ON ttks(cliente_id);\n        CREATE INDEX IF NOT EXISTS idx_ttks_creation_date ON ttks(creation_date);\n        CREATE INDEX IF NOT EXISTS idx_ttks_state ON ttks(state);\n        CREATE INDEX IF NOT EXISTS idx_ttks_priority ON ttks(priority);\n        , parameters: None","logger":"airflow.task.hooks.airflow.providers.***.hooks.***.PostgresHook","filename":"sql.py","lineno":810}
{"timestamp":"2025-11-29T04:16:32.914348Z","level":"info","event":"‚úÖ Tabela 'ttks' criada/verificada com sucesso!","logger":"task.stdout"}
{"timestamp":"2025-11-29T04:16:32.914336Z","level":"info","event":"Done. Returned value was: {'status': 'success'}","logger":"airflow.task.operators.airflow.providers.standard.decorators.python._PythonDecoratedOperator","filename":"python.py","lineno":215}
{"timestamp":"2025-11-29T04:16:32.914673Z","level":"info","event":"Pushing xcom","ti":"RuntimeTaskInstance(id=UUID('019acdd3-a891-78f3-95d7-b9c7615084de'), task_id='criar_tabelas', dag_id='processar_ttks_para_***', run_id='scheduled__2025-11-29T04:00:00+00:00', try_number=1, dag_version_id=UUID('019acc19-c3a5-7c0a-bcc7-dc817cf65a67'), map_index=-1, hostname='a20f9d5b7e4f', context_carrier={}, task=<Task(_PythonDecoratedOperator): criar_tabelas>, bundle_instance=LocalDagBundle(name=dags-folder), max_tries=2, start_date=datetime.datetime(2025, 11, 29, 4, 16, 32, 48582, tzinfo=datetime.timezone.utc), end_date=None, state=<TaskInstanceState.RUNNING: 'running'>, is_mapped=False, rendered_map_index=None)","logger":"task","filename":"task_runner.py","lineno":1360}
{"timestamp":"2025-11-29T04:16:32.963448Z","level":"info","event":"Task instance in success state","logger":"task.stdout"}
{"timestamp":"2025-11-29T04:16:32.964525Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.RUNNING","logger":"task.stdout"}
{"timestamp":"2025-11-29T04:16:32.964812Z","level":"info","event":"Task operator:<Task(_PythonDecoratedOperator): criar_tabelas>","logger":"task.stdout"}
